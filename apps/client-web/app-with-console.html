<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App with Console Capture</title>
    <style>
        body { margin: 0; font-family: monospace; background: #1e1e1e; color: #d4d4d4; }
        #split { display: flex; height: 100vh; }
        #app { flex: 1; overflow: hidden; border-right: 2px solid #333; }
        #logs { flex: 0 0 400px; overflow-y: auto; background: #252526; padding: 10px; border-left: 2px solid #333; }
        .log { margin: 2px 0; padding: 2px 4px; border-radius: 2px; white-space: pre-wrap; word-wrap: break-word; font-size: 12px; }
        .log.error { background: #3d2626; color: #f48771; }
        .log.warn { background: #3d3d26; color: #dcdcaa; }
        .log.info { color: #4ec9b0; }
        .log.log { color: #d4d4d4; }
        .log.debug { color: #9cdcfe; }
        #logs-title { font-weight: bold; padding: 5px 0; border-bottom: 1px solid #444; margin-bottom: 5px; color: #007acc; }
    </style>
</head>
<body>
    <div id="split">
        <div id="app">
            <div id="root"></div>
        </div>
        <div id="logs">
            <div id="logs-title">Console Output</div>
            <div id="log-container"></div>
        </div>
    </div>

    <script>
        // Redirect console to log div
        const logContainer = document.getElementById('log-container');
        const maxLogs = 500;
        let logCount = 0;

        function addLog(type, args) {
            if (logCount >= maxLogs) {
                logContainer.removeChild(logContainer.firstChild);
            } else {
                logCount++;
            }

            const msg = Array.from(args).map(arg => {
                if (typeof arg === 'object') {
                    try { return JSON.stringify(arg, null, 2); }
                    catch { return String(arg); }
                }
                return String(arg);
            }).join(' ');

            const entry = document.createElement('div');
            entry.className = `log ${type}`;
            entry.textContent = msg;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        // Intercept console methods
        const orig = { log: console.log, error: console.error, warn: console.warn, info: console.info, debug: console.debug };
        console.log = (...args) => { orig.log(...args); addLog('log', args); };
        console.error = (...args) => { orig.error(...args); addLog('error', args); };
        console.warn = (...args) => { orig.warn(...args); addLog('warn', args); };
        console.info = (...args) => { orig.info(...args); addLog('info', args); };
        console.debug = (...args) => { orig.debug(...args); addLog('debug', args); };

        // Global error handler
        window.addEventListener('error', (evt) => {
            addLog('error', [`UNCAUGHT: ${evt.message} @ ${evt.filename}:${evt.lineno}:${evt.colno}`]);
        });

        window.addEventListener('unhandledrejection', (evt) => {
            addLog('error', [`UNHANDLED REJECTION: ${evt.reason}`]);
        });

        console.log('âœ“ Console capture initialized');
        console.log('ðŸ“± Loading React app...');
    </script>

    <!-- Load the React app -->
    <script type="module" src="/src/main.tsx"></script>
</body>
</html>
